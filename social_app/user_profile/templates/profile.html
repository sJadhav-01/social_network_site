{% extends 'base.html' %} {% block content %}

<div class="container ms-6 user-links">
  <div class="row">
    <div class="col-3 mt-4">
      {% if request.session.user %}
      <h2>{{ user.first_name}} {{user.last_name}}</h2>

      <ul class="list-group mt-4 me-5">
        <li class="list-group-item">
          <a href="/editprofiledetails/">Edit profile details</a>
        </li>
        <li class="list-group-item">
          <a href="/addotherdetails/">Add other details</a>
        </li>
        <li class="list-group-item"><a href="/friends/">Friends</a></li>
      </ul>
      {% endif %}
    </div>

    <div class="col-6 mt-4">
      <!-- profile details  -->
      <div class="profiledetails">
        <div class="card mb-3" style="width: 36rem">
          <img src="..." class="card-img-top" alt="..." />
          <div class="card-body">
            <h5 class="card-title">{{user.first_name}} {{user.last_name}}</h5>
            <p class="card-text">user's Bio</p>
          </div>
          <ul class="list-group list-group-flush">
            <li class="list-group-item">Hobbies</li>
            <li class="list-group-item">Location</li>
          </ul>
        </div>
      </div>

      <!-- create post -->
      <div class="card mb-3" style="width: 36rem; border: none">
        <div class="card-body">
          <h3 class="card-title">What's in your mind</h3>
          <form method="post" action="/profile/">
            {% csrf_token %}
            <textarea
              type="textarea"
              class="form-control"
              id=""
              name="post"
              rows="3"
            ></textarea>
            <div class="d-flex justify-content-end mt-4">
              <button type="submit" class="btn btn-primary btn-sm col-md-2">
                Post
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- user posts -->
      <div class="userposts">
        {% for post in posts %}
        <div
          class="card mt-4"
          style="width: 36rem; border: none"
          id="card-{{ post.id }}"
        >
          <div class="card-body">
            <div class="d-flex justify-content-between">
              <h6 class="card-title">
                {{ post.user.first_name }} {{ post.user.last_name }}
              </h6>

              {% if post.user.id == request.session.user %}
              <button
                class="btn btn-sm btn-danger mt-1 post-delete-btn"
                data-post-id="{{post.id}}"
                data-card-id="card-{{post.id}}"
              >
                Delete
              </button>
              {% endif %}
            </div>
            <div class="card mt-2">
              <p class="card-text p-2">{{ post.post_content }}</p>
            </div>
            <div class="reaction mt-2">
              <button
                class="like-btn me-1"
                style="border: none; background-color: transparent"
                data-post-id="{{post.id}}"
              >
                {% if post.id in liked_post_ids %}
                <i class="bi bi-hand-thumbs-up-fill"></i>
                {% else %} <i class="bi bi-hand-thumbs-up"></i> {% endif %}
              </button>
              <span class="me-1" id="like-count-{{ post.id }}"
                >{{post.like_count}}</span
              >
              <button
                class="btn comment-btn me-1"
                data-div-id="comment-sect-{{post.id}}"
                data-post-id="{{post.id}}"
                style="border: none"
              >
                Comment
              </button>
              <span class="me-1" id="comment-count-{{ post.id }}"
                >{{post.comment_count}}</span
              >

              <div hidden id="comment-sect-{{post.id}}">
                <textarea
                  class="form-control comment"
                  id="post-comment-{{post.id}}"
                  data-post-id="{{post.id}}"
                ></textarea>
                <button
                  class="m-2 save-comment-btn"
                  data-textarea-id="post-comment-{{post.id}}"
                  data-div-id="comment-sect-{{post.id}}"
                >
                  Post comment
                </button>
                <div
                  class="comments-container m-1"
                  id="comments-container-{{post.id}}"
                ></div>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
